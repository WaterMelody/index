##多线程面试题
###1.线程的基本概念、线程的基本状态及其之间的关系？进程和线程区别？

---------

###1.线程的基本概念、线程的基本状态及其之间的关系？进程和线程区别？
**线程**  

* 它是CPU调度和分派的基本单位，是进程的一个实体。
* 线程自己不拥有系统资源，只有一点在运行中必不可少的资源（栈），与同进行的其他线程共享进程所拥有的全部资源。堆是进程共有的，栈是线程私有的，如果有需要也可以自己开辟私有堆。
* 一个线程可以创建和撤销另一个线程，同一个进程中的多个线程之间可以并发执行。
* 单个CPU也可以多线程，但实际运行时候多线程会根据调度算法依次运行。

* **区别**
	1. 调度和资源。线程是CPU调度和分派的基本单位，进程是拥有资源的基本单位。
	2. 并发性。除了进程之间并发，一个进程可以创建多个线程来执行同一程序的不同部分。
	3. 开销。进程还要创建和销毁资源，开销大。线程不拥有资源，但可以访问进程资源，创建线程更快。
* **状态：**运行、阻塞、挂起阻塞、就绪、挂起就绪
* 状态之间的转换：
	* 准备就绪-->运行：被CPU调度执行
	* 运行----->阻塞：运行中进程，进行I/O请求或者不能得到所请求的资源
	* 运行----->就绪：进程执行完毕（或者时间片用完）
	* 阻塞---①-->挂起阻塞--②-->挂起就绪：①将阻塞的挂起  ②当导致进程阻塞的I/O操作在用户重启进程前完成（称为唤醒）
	* 挂起阻塞----->阻塞： 当用户在I/O操作结束之前重启进程
	* 就绪（或运行）----->挂起就绪，当进程恢复后，挂起就绪就变成就绪。
	
	
###2.C++中多线程有几种实现方法，都是什么？
windows下通过api CreateThread，linux下则常用pthread库，这些都是最底层的实现.最新的C++11标准里增加了std::thread多线程库，使用第三方库的话就更多了，比如boost的thread等等，不推荐使用vc自家的_beginthread，尤其有跨平台需求的时候。

###3.多线程同步和互斥有何异同，在什么情况下分别使用他们？举例说明。
*    线程间的同步方法大体可分为两类：用户模式和内核模式。顾名思义，内核模式就是指利用系统内核对象的单一性来进行同步，使用时需要切换内核态与用户态，而用户模式就是不需要切换到内核态，只在用户态完成操作。</br>
	用户模式下的方法有：原子操作（例如一个单一的全局变量），临界区。</br>
	内核模式下的方法有：事件，信号量，互斥量。</br>
	
* 当有多个线程的时候，经常需要去同步这些线程以访问同一个数据或资源。例如，假设有一个程序，其中一个线程用于把文件读到内存，而另一个线程用于统计文件中的字符数。当然，在把整个文件调入内存之前，统计它的计数是没有意义的。但是，由于每个操作都有自己的线程，操作系统会把两个线程当作是互不相干的任务分别执行，这样就可能在没有把整个文件装入内存时统计字数。为解决此问题，你必须使两个线程同步工作。
* 所谓同步，是指散步在不同进程之间的若干程序片断，它们的运行必须严格按照规定的某种先后次序来运行，这种先后次序依赖于要完成的特定的任务。如果用对资源的访问来定义的话，同步是指在互斥的基础上（大多数情况），通过其它机制实现访问者对资源的有序访问。在大多数情况下，同步已经实现了互斥，特别是所有写入资源的情况必定是互斥的。少数情况是指可以允许多个访问者同时访问资源。
* 所谓互斥，是指散布在不同进程之间的若干程序片断，当某个进程运行其中一个程序片段时，其它进程就不能运行它们之中的任一程序片段，只能等到该进程运行完这个程序片段后才可以运行。如果用对资源的访问来定义的话，互斥某一资源同时只允许一个访问者对其进行访问，具有唯一性和排它性。但互斥无法限制访问者对资源的访问顺序，即访问是无序的。</br>
###4.进程间通信的方式？
（1）管道（pipe）及有名管道（named pipe）：管道可用于具有亲缘关系的父子进程间的通信，有名管道除了具有管道所具有的功能外，它还允许无亲缘关系进程间的通信。数据只能单向流动。

（2）信号（signal）：信号是在软件层次上对中断机制的一种模拟，它是比较复杂的通信方式，用于通知进程有某事件发生，一个进程收到一个信号与处理器收到一个中断请求效果上可以说是一致的。

（3）消息队列（message queue）：消息队列是消息的链接表，它克服了上两种通信方式中信号量有限的缺点，具有写权限得进程可以按照一定得规则向消息队列中添加新信息；对消息队列有读权限得进程则可以从消息队列中读取信息。

（4）共享内存（shared memory）：可以说这是最有用的进程间通信方式。共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问，不同进程可以及时看到对方进程中对共享内存中数据得更新。这种方式需要依靠某种同步操作，如互斥锁和信号量等。

（5）信号量（semaphore）：信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。主要作为进程之间及同一种进程的不同线程之间得同步和互斥手段。

（6）套接字（socket）：这是一种更为一般得进程间通信机制，它可用于网络中不同机器之间的进程间通信，应用非常广泛。
###5.临界区（Critical Section）和互斥量（Mutex）
    两者都可以用于同一进程中不同子线程对资源的互斥访问。
    互斥量是内核对象，因此还可以用于不同进程中子线程对资源的互斥访问。
    互斥量可以很好的解决由于线程意外终止资源无法释放的问题。
###6.生产者消费者问题
   这是一个非常经典的多线程题目，题目大意如下：有一个生产者在生产产品，这些产品将提供给若干个消费者去消费，为了使生产者和消费者能并发执行，在两者之间设置一个有多个缓冲区的缓冲池，生产者将它生产的产品放入一个缓冲区中，消费者可以从缓冲区中取走产品进行消费，所有生产者和消费者都是异步方式运行的，但它们必须保持同步，即不允许消费者到一个空的缓冲区中取产品，也不允许生产者向一个已经装满产品且尚未被取走的缓冲区中投放产品。
###7.读者写者问题
   这也是一个非常经典的多线程题目，题目大意如下：有一个写者很多读者，多个读者可以同时读文件，但写者在写文件时不允许有读者在读文件，同样有读者读时写者也不能写。
   
  整理自：[博客](http://blog.csdn.net/jjj19891128/article/details/24393661)  [多线程面试大全](http://blog.csdn.net/column/details/killthreadseries.html)
	